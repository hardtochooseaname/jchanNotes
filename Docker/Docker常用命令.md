# Dockerå¸¸ç”¨å‘½ä»¤

Docker å¸¸ç”¨å‘½ä»¤å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªä¸»è¦ç±»åˆ«ï¼Œæ¶µç›–äº†é•œåƒã€å®¹å™¨ã€ç½‘ç»œã€æ•°æ®å·ç­‰å¸¸è§æ“ä½œï¼š

## ğŸ³ ä¸€ã€é•œåƒç›¸å…³

| å‘½ä»¤                            | è¯´æ˜                                       |
| ------------------------------- | ------------------------------------------ |
| `docker pull <é•œåƒ>`            | æ‹‰å–é•œåƒï¼ˆå¦‚ï¼š`docker pull ubuntu`ï¼‰       |
| `docker images`                 | æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨                           |
| `docker rmi <é•œåƒ>`             | åˆ é™¤é•œåƒï¼ˆå¦‚ï¼š`docker rmi ubuntu:latest`ï¼‰ |
| `docker build -t <åç§°:æ ‡ç­¾> .` | ä½¿ç”¨ Dockerfile æ„å»ºé•œåƒ                   |
| `docker tag <æºé•œåƒ> <æ–°æ ‡ç­¾>`  | ç»™é•œåƒæ‰“æ ‡ç­¾                               |

## ğŸ§± äºŒã€å®¹å™¨ç®¡ç†

| å‘½ä»¤                            | è¯´æ˜                                                  |
| ------------------------------- | ----------------------------------------------------- |
| `docker run [é€‰é¡¹] <é•œåƒ>`      | åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼ˆå¦‚ï¼š`docker run -it ubuntu bash`ï¼‰    |
| `docker ps`                     | æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨                                    |
| `docker ps -a`                  | æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢ï¼‰                            |
| `docker start <å®¹å™¨å/ID>`      | å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨                                      |
| `docker stop <å®¹å™¨å/ID>`       | åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨                                      |
| `docker restart <å®¹å™¨å/ID>`    | é‡å¯å®¹å™¨                                              |
| `docker rm <å®¹å™¨å/ID>`         | åˆ é™¤å®¹å™¨ï¼ˆéœ€å…ˆåœæ­¢ï¼‰                                  |
| `docker exec -it <å®¹å™¨> <å‘½ä»¤>` | åœ¨è¿è¡Œä¸­çš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ï¼ˆå¦‚ï¼šè¿›å…¥å®¹å™¨ï¼‰              |
| `docker attach <å®¹å™¨å/ID>`     | è¿æ¥åˆ°å®¹å™¨æ§åˆ¶å°ï¼ˆä¸æ¨è detach æ—¶ä½¿ç”¨ Ctrl + P + Qï¼‰ |

## ğŸ“¦ ä¸‰ã€æ•°æ®å·ï¼ˆVolumesï¼‰

| å‘½ä»¤                              | è¯´æ˜                     |
| --------------------------------- | ------------------------ |
| `docker volume create <åç§°>`     | åˆ›å»ºæ•°æ®å·               |
| `docker volume ls`                | æŸ¥çœ‹æ‰€æœ‰æ•°æ®å·           |
| `docker volume inspect <åç§°>`    | æŸ¥çœ‹å·è¯¦æƒ…               |
| `docker volume rm <åç§°>`         | åˆ é™¤å·                   |
| `docker run -v <å·å>:<å®¹å™¨è·¯å¾„>` | ä½¿ç”¨å·æŒ‚è½½æ•°æ®ï¼ˆæŒä¹…åŒ–ï¼‰ |

## ğŸŒ å››ã€ç½‘ç»œç®¡ç†

| å‘½ä»¤                                | è¯´æ˜                 |
| ----------------------------------- | -------------------- |
| `docker network ls`                 | æŸ¥çœ‹ç½‘ç»œåˆ—è¡¨         |
| `docker network create <åç§°>`      | åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œ       |
| `docker network inspect <åç§°>`     | æŸ¥çœ‹ç½‘ç»œè¯¦æƒ…         |
| `docker run --network <åç§°> ...`   | æŒ‡å®šå®¹å™¨æ‰€è¿æ¥çš„ç½‘ç»œ |
| `docker network connect/disconnect` | è¿æ¥/æ–­å¼€å®¹å™¨ä¸ç½‘ç»œ  |

## ğŸ› ï¸ äº”ã€ç³»ç»Ÿä¿¡æ¯ä¸æ¸…ç†

| å‘½ä»¤                  | è¯´æ˜                                 |
| --------------------- | ------------------------------------ |
| `docker info`         | æŸ¥çœ‹ Docker ç³»ç»Ÿä¿¡æ¯                 |
| `docker version`      | æŸ¥çœ‹ Docker ç‰ˆæœ¬                     |
| `docker stats`        | æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ                 |
| `docker system df`    | æŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨                     |
| `docker system prune` | æ¸…ç†æ— ç”¨çš„é•œåƒã€å®¹å™¨ã€ç½‘ç»œç­‰ï¼ˆæ…ç”¨ï¼‰ |

------

## ğŸ“ ç¤ºä¾‹ï¼šå¯åŠ¨ä¸€ä¸ªå¸¦å·å’Œç«¯å£æ˜ å°„çš„å®¹å™¨

```bash
docker run -d -p 8080:80 -v mydata:/data --name web nginx
```

è¯´æ˜ï¼šåå°å¯åŠ¨ nginx å®¹å™¨ï¼Œå°†ä¸»æœº 8080 æ˜ å°„åˆ°å®¹å™¨ 80ï¼ŒæŒ‚è½½å· `mydata` åˆ°å®¹å™¨ `/data` è·¯å¾„ã€‚



# docker run

### **1. åŸºç¡€æ§åˆ¶å‚æ•°**

|     å‚æ•°     |              è¯´æ˜              |                 ç¤ºä¾‹                  |
| :----------: | :----------------------------: | :-----------------------------------: |
|   **`-d`**   | åå°è¿è¡Œå®¹å™¨ï¼ˆdetached modeï¼‰  |         `docker run -d nginx`         |
| **`--name`** |          æŒ‡å®šå®¹å™¨åç§°          |  `docker run --name my-nginx nginx`   |
|  **`--rm`**  | å®¹å™¨é€€å‡ºåè‡ªåŠ¨åˆ é™¤ï¼ˆæµ‹è¯•å¸¸ç”¨ï¼‰ | `docker run --rm alpine echo "hello"` |
|  **`-it`**   |    äº¤äº’å¼è¿è¡Œï¼ˆåˆ†é…ä¼ªç»ˆç«¯ï¼‰    |     `docker run -it ubuntu bash`      |

------

### **2. ç½‘ç»œä¸ç«¯å£æ˜ å°„**

|      å‚æ•°       |                   è¯´æ˜                   |                ç¤ºä¾‹                 |
| :-------------: | :--------------------------------------: | :---------------------------------: |
|    **`-p`**     |    ç«¯å£æ˜ å°„ï¼ˆ`å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£`ï¼‰     |    `docker run -p 8080:80 nginx`    |
| **`--network`** |               æŒ‡å®šç½‘ç»œæ¨¡å¼               |  `docker run --network=host nginx`  |
|  **`--link`**   | è¿æ¥å…¶ä»–å®¹å™¨ï¼ˆå·²è¿‡æ—¶ï¼Œæ¨èç”¨è‡ªå®šä¹‰ç½‘ç»œï¼‰ | `docker run --link redis:redis app` |

------

### **3. ç¯å¢ƒå˜é‡ä¸é…ç½®**

|       å‚æ•°       |                è¯´æ˜                 |                ç¤ºä¾‹                 |
| :--------------: | :---------------------------------: | :---------------------------------: |
|     **`-e`**     |            è®¾ç½®ç¯å¢ƒå˜é‡             |  `docker run -e MY_VAR=value app`   |
| **`--env-file`** |         ä»æ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡          |  `docker run --env-file=.env app`   |
|     **`-v`**     | æŒ‚è½½æ•°æ®å·ï¼ˆ`å®¿ä¸»æœºè·¯å¾„:å®¹å™¨è·¯å¾„`ï¼‰ | `docker run -v /data:/app/data app` |

------

### **4. èµ„æºé™åˆ¶**

|      å‚æ•°       |          è¯´æ˜           |               ç¤ºä¾‹                |
| :-------------: | :---------------------: | :-------------------------------: |
| **`--memory`**  | é™åˆ¶å†…å­˜ï¼ˆå•ä½ï¼š`m/g`ï¼‰ |  `docker run --memory=512m app`   |
|  **`--cpus`**   |      é™åˆ¶CPUæ ¸å¿ƒæ•°      |    `docker run --cpus=1.5 app`    |
| **`--restart`** |  å®¹å™¨é€€å‡ºæ—¶çš„é‡å¯ç­–ç•¥   | `docker run --restart=always app` |

------

### **5. é•œåƒä¸å‘½ä»¤æ§åˆ¶**

|        å‚æ•°        |       è¯´æ˜       |                  ç¤ºä¾‹                   |
| :----------------: | :--------------: | :-------------------------------------: |
| **`--entrypoint`** | è¦†ç›–é»˜è®¤å…¥å£å‘½ä»¤ | `docker run --entrypoint=/bin/bash app` |
| **`-v`** (é•œåƒå·)  |  æŒ‚è½½é•œåƒä¸­çš„å·  |        `docker run -v /data app`        |
|    **`--pull`**    | å¼ºåˆ¶æ‹‰å–æœ€æ–°é•œåƒ |    `docker run --pull=always nginx`     |



# dockerå®æˆ˜

### é•œåƒæ‰“åŒ…ä¸åŠ è½½

```sh
# åœ¨æºæœºå™¨æ‰§è¡Œ
docker save -o my-app.tar my-app:v1
scp my-app.tar ubuntu@192.168.1.100:/home/ubuntu/

# åœ¨ç›®æ ‡æœºå™¨æ‰§è¡Œ
ssh ubuntu@192.168.1.100
docker load -i /home/ubuntu/my-app.tar
docker run -d --name app my-app:v1
```

