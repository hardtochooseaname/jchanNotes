# 毕设实践

## Schema设计

### 如何判断某一点知识是节点 or 属性？

例如，人物A的生日、发表的文章、拥有的某个物品，这三点知识应该是作为属性还是应该是节点，通常有以下几点判断依据：

1. 是否是固有属性：生日是人物的固有属性，所以一般情况下设置为人物节点的属性。
2. 是否会与其他实体产生关联：一般情况下，某个具体的“时间”并不会与其他实体产生关联，但是如果知识图谱是用于关于《中国历史》、《新闻记录》之类的，“时间”会作为关键节点与大量节点产生关联时，就需要把人物生日设置为节点。
3. 自身是否有固有属性：如果一个知识/事实其自身也有固有属性，例如”人物发表的文章“，文章可能会有重大影响、核心观点这些属性，那么“文章”就不适合作为人物的属性，而是应该作为单独的节点。



### 基于 LLM 的半开放式动态 Schema 构建策略

#### 1. 核心设计哲学

- **定义**：一种打破传统预定义僵化本体的模式，允许 Schema 在提取过程中根据数据特征动态生长，但通过严谨的 Prompt 约束（Few-Shot + CoT）来防止类型泛滥。
- **适用场景**：LLM 驱动的自动化知识图谱构建（尤其是针对特定领域如“电子科技史”、“行业报告”等）。
- **目标**：平衡图谱的“结构化规范”与“语义灵活性”，解决冷启动困难和长尾知识丢失的问题。

#### 2. 阶段一：Schema 初始化 (Initialization)

- **触发时机**：用户新建图谱项目，并输入关于该图谱的**“领域/内容描述”**时。
- **基础模板**：系统预置一个 Schema 初始化的 Meta-Prompt 模板，包含两个待填充槽位：
  1. **知识图谱总体概述 (KG Overview)**：定义图谱的边界和用途。
  2. **基础实体类型列表 (Initial Entity List)**：预置最通用的元类型（如 Person, Location, Event）。
- **生成流程**：
  1. 将用户的“内容描述”输入给 LLM。
  2. LLM 基于描述，在基础模板之上，**推断并补充**若干领域特定的基础类型（例如：电子史 -> 补充 Organization, Object, Time）。
  3. 形成一个**“最小可行本体” (Minimum Viable Ontology)** 作为提取的起点。

#### 3. 阶段二：节点 vs. 属性的判别逻辑 (Decision Logic)

在提取过程中，LLM 需要判断一个信息点是作为**独立节点**存在，还是仅作为**属性**依附于其他节点。

- **判别依据（写入 System Prompt）**：
  1. **原子性/固有属性 (Atomicity)**：
     - 如果是简单的值（日期、数字、短语）且无自身描述。
     - *判定*：**属性**。
     - *例*：人物的生日、身高。
  2. **连接性/关联价值 (Connectivity)**：
     - 如果该信息在领域中具有枢纽作用，会连接大量其他实体。
     - *判定*：**节点**。
     - *例*：《中国历史》图谱中的“时间点”（连接大量事件）；《电子史》中的“实验室”（连接多位科学家）。
  3. **自身复杂性 (Self-Complexity)**：
     - 如果该信息本身拥有固有属性（如文章有影响因子、物品有发明时间）。
     - *判定*：**节点**。
     - *例*：人物发表的“文章”、发明的“物品”。

#### 4. 阶段三：Schema 动态演进与控制 (Evolution & Control)

允许在提取过程中发现新类型，但必须严控“Schema 爆炸”和“同义词分裂”。

- **演进机制**：

  - 将当前的实体类型列表动态注入到 Prompt 中。
  - 当 LLM 遇到无法归类的实体时，允许其输出 `Decision: NEW` 并建议新类型。
  - 一旦采纳，更新类型列表，用于后续提取（In-Context Learning）。

- 控制手段：Few-Shot + CoT (关键技术点)

  利用少样本提示（Few-Shot）教导 LLM 归纳标准，并强制要求输出理由（Reasoning）。

  - **样本 1：强行归纳 (Generalization)**
    - *场景*：遇到“晶体管”，现有类型有 `Object`。
    - *逻辑*：虽然不同，但本质是物品，**归入 `Object`**。
    - *目的*：防止为每个零件建一个类型。
  - **样本 2：泛化命名 (Naming Standard)**
    - *场景*：遇到“广义相对论”，现有类型无匹配。
    - *逻辑*：**新建 `Concept`**，而不是新建 `Theory`。
    - *目的*：创建一个高层级的通用类型，涵盖理论、定律、术语。
  - **样本 3：语义断层 (Semantic Gap)**
    - *场景*：遇到“1998年”，现有类型只有人/地/事。
    - *逻辑*：时间是全新维度，无法兼容，**新建 `Time`**。
    - *目的*：仅在本质不同时才扩展 Schema。

#### 5. 系统优势

1. **鲁棒性**：通过 Few-Shot 明确了“归纳”和“新建”的边界，杜绝了相近实体类型（如 Scientist/Researcher）的重复创建。
2. **灵活性**：不需要预先穷举所有类型，能够自适应不同领域的知识提取。
3. **可解释性**：要求 LLM 输出判断理由（Reasoning），便于后续人工审计或调试。







## 小说相关

需要持久化记忆的内容：

1. 总体设定
   - 修炼体系设定：血脉、体质、战力修炼（炼体、炼气、神识、修魔、修妖及各种兵器等）、旁门修炼（符箓、阵法、炼器、炼丹、商道、官道、盗道等等）、功法道术等修炼法
   - 地理环境设定：地图设置，特殊地理环境（如飞岛、虫洞、天然凶地等），特殊物理规律
   - 势力格局设定
   - 种族设定：人妖仙神魔，虫兽草木海，尸鬼，灵物
   - 世界历史
   - 风俗习惯：称呼、礼仪、骂人的话
   - 社会架构：国家、宗门、学院、帮派等等

2. 故事信息：大概率需要用图谱形式来存放故事信息
3. 写作计划信息
   - 故事大纲
   - 故事走向
   - 关键故事情节的具体发展过程
4. 写作偏好/写作风格信息
   - 用词偏好
   - 取名偏好
   - 故事走向偏好



## 世界观&修炼体系设定

### 世界观主旋律：社会化修仙

- 世界上武道修炼并不是唯一一条路，是众多职业之一，同时也是最受欢迎、选择的人最多的一条道路。
- 就好像现代社会，读书毕业进公司打工，这是80%的人的选择，也是很多家长所说的“读书才是唯一的出路”。但是也有当老板的，各种各样创业的，从事黑灰产业的，体制内的等等。那么在玄幻世界，武道修炼被大多数人人为的安身立命之本的同时，也有其他众多职业道路。而且，一个真实的社会也必须要有各种各样职业，才能够正常运行，这是一个世界运行规律的问题。不能全是消费者，还要有统治者；不能全是打工人（众多的修武者），还要有老板（管理修武者的人，自己不一定武功高超，但是手中有权力有资源，其手下的修武者必须要仰仗他）、官二代（自身能力不突出也能当管理者）、富二代（自己摆烂也能活得好好的）、X二代（关键点都是由于可以依仗长辈，不用拼死拼活修武）。

- 注意，对于武道修炼者的非修武的上位者，不应该像是传统小说中的那样，只要战力通天，老板在我面前都是孙子。应该像现代社会一样，不管老板是不是废物傻逼，老板都是老板，都是掌握牛马生杀大权的人，再有能力的牛马也翻不了天。**这是社会结构的基调**。

### 修炼体系

修武者的修炼越高深，寿命越久，但是如果其他职业不修炼，寿命差距过大会导致不合理。所以设定与人们寿命关联的是**灵力等级**，灵力等级越高，寿命越长。而所有职业都可以修炼灵力，修炼灵力的门槛和难度不应过大，但是也要合理设置，**注意平衡**。

**灵力**：可以比作人类的力量，力量越大战力越强。但是灵力绝对不是评价战力的唯一标准，灵力运用法门（功法）决定了自身灵力运用的能力，灵力运用法门越高深，自身灵力就能发挥出来更多。（就好像内家拳不断在站桩和练法中，逐渐寻求自身力量的整合，要求全身有10分力，就能整合10分力从手掌发出去）

- **灵力等级**：代表灵力总量
- **灵力属性**：代表不同能力偏向。例如治疗者职业的灵力属性可能就是草木属性、生命属性等。

