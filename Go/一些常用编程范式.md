# å‡½æ•°å¼ç¼–ç¨‹ - Functional Program

å‡½æ•°å¼ç¼–ç¨‹å°±æ˜¯å……åˆ†åˆ©ç”¨å‡½æ•°**ç¬¬ä¸€å…¬æ°‘**çš„ç‰¹æ€§ï¼Œé€šè¿‡åœ¨ä»£ç ä¸­å¤§é‡è¿ç”¨**çº¯å‡½æ•°**ï¼Œå¯¹ä»£ç è¿›è¡Œå¤§é‡**é‡ç”¨**ï¼Œä½¿å¾—ä»£ç ç»“æ„æ›´**ç®€æ´**ã€‚

çº¯å‡½æ•°ç¼–ç¨‹çš„ç»å…¸èŒƒå¼å°±æ˜¯**â€œå‡½æ•°ç»„åˆâ€**å’Œ**â€œé«˜é˜¶å‡½æ•°â€**ï¼Œé€šè¿‡ç»„åˆå¤šä¸ªçº¯å‡½æ•°æ¥å®Œæˆå¤æ‚çš„æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æ ¸å¿ƒèŒƒå¼å’Œæ¦‚å¿µï¼š

------

### 1. **å‡½æ•°ç»„åˆï¼ˆFunction Compositionï¼‰**

å‡½æ•°ç»„åˆå°±æ˜¯å°†å¤šä¸ªçº¯å‡½æ•°ç»„åˆåœ¨ä¸€èµ·ï¼Œä½¿å¾—ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥ã€‚
 åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œç»„åˆå¯ä»¥é€šè¿‡ `compose` å‡½æ•°æ¥å®ç°ï¼š

**ä¼ªä»£ç ç¤ºä¾‹ï¼š**

```go
compose := func(f, g func(int) int) func(int) int {
    return func(x int) int {
        return f(g(x))
    }
}

double := func(x int) int {
    return x * 2
}

increment := func(x int) int {
    return x + 1
}

result := compose(double, increment)(3)  // ç»“æœä¸º 8
```

**è§£é‡Šï¼š**

- `increment(3)` å¾—åˆ° `4`
- `double(4)` å¾—åˆ° `8`
- æœ€ç»ˆè¿”å›å€¼æ˜¯ `8`

------

### 2. **é«˜é˜¶å‡½æ•°ï¼ˆHigher-Order Functionsï¼‰**

é«˜é˜¶å‡½æ•°æ˜¯æŒ‡**æ¥æ”¶å‡½æ•°ä½œä¸ºå‚æ•°**æˆ–**è¿”å›å‡½æ•°**çš„å‡½æ•°ã€‚
 Go ä¸­çš„é«˜é˜¶å‡½æ•°ç¤ºä¾‹ï¼š

```go
func mapFunc(arr []int, f func(int) int) []int {
    result := make([]int, len(arr))
    for i, v := range arr {
        result[i] = f(v)
    }
    return result
}

func square(x int) int {
    return x * x
}

func cube(x int) int {
    return x * x * x
}

nums := []int{1, 2, 3, 4}
squares := mapFunc(nums, square)  // [1, 4, 9, 16]
cubes := mapFunc(nums, cube)      // [1, 8, 27, 64]
```

**è§£é‡Šï¼š**

- `mapFunc` æ˜¯ä¸€ä¸ª**é«˜é˜¶å‡½æ•°**ï¼Œæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚
- é€šè¿‡ä¼ é€’ä¸åŒçš„å¤„ç†å‡½æ•°ï¼Œå®ç°äº†å¯¹åˆ—è¡¨çš„çµæ´»æ“ä½œã€‚

------

### 3. **æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰**

æŸ¯é‡ŒåŒ–æ˜¯å°†ä¸€ä¸ªå¤šå‚æ•°å‡½æ•°è½¬æ¢ä¸ºä¸€ç³»åˆ—**ä¸€å…ƒå‡½æ•°**çš„è¿‡ç¨‹ã€‚
 **ç¤ºä¾‹ï¼š**

```go
func add(x int) func(int) int {
    return func(y int) int {
        return x + y
    }
}

addFive := add(5)
result := addFive(3)  // 8
```

**è§£é‡Šï¼š**

- `add(5)` è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°ã€‚
- `addFive(3)` ç›¸å½“äº `5 + 3`ã€‚

------

### 4. **æƒ°æ€§æ±‚å€¼ï¼ˆLazy Evaluationï¼‰**

æƒ°æ€§æ±‚å€¼æ˜¯æŒ‡åœ¨**éœ€è¦æ—¶æ‰è®¡ç®—**ï¼Œè€Œä¸æ˜¯ç«‹å³æ±‚å€¼ã€‚
 åœ¨ Go ä¸­å¯ä»¥ç”¨**é—­åŒ…**æ¥å®ç°æƒ°æ€§æ±‚å€¼ï¼š

```go
func lazyAdd(a, b int) func() int {
    return func() int {
        return a + b
    }
}

sum := lazyAdd(3, 4)  // ä¸è®¡ç®—
fmt.Println(sum())    // æ­¤æ—¶æ‰è®¡ç®—ï¼Œè¾“å‡º 7
```

**è§£é‡Šï¼š**

- `lazyAdd` è¿”å›ä¸€ä¸ªé—­åŒ…ï¼Œåœ¨çœŸæ­£è°ƒç”¨æ—¶æ‰æ‰§è¡ŒåŠ æ³•æ“ä½œã€‚

------

### 5. **ä¸å¯å˜æ€§ï¼ˆImmutabilityï¼‰**

å‡½æ•°å¼ç¼–ç¨‹å¼ºè°ƒ**æ•°æ®ä¸å¯å˜**ï¼Œå³æ“ä½œåç”Ÿæˆæ–°çš„æ•°æ®è€Œéä¿®æ”¹åŸæ•°æ®ã€‚
 è™½ç„¶ Go æœ¬èº«ä¸æ˜¯ä¸¥æ ¼çš„å‡½æ•°å¼è¯­è¨€ï¼Œä½†å¯ä»¥å€ŸåŠ©æ‹·è´æ¥å®ç°ç±»ä¼¼æ•ˆæœï¼š

```go
func addElement(arr []int, elem int) []int {
    newArr := append([]int(nil), arr...)
    newArr = append(newArr, elem)
    return newArr
}

original := []int{1, 2, 3}
newArr := addElement(original, 4)
fmt.Println(original)  // [1, 2, 3]
fmt.Println(newArr)    // [1, 2, 3, 4]
```

**è§£é‡Šï¼š**

- ä¸ç›´æ¥ä¿®æ”¹åŸæ•°ç»„ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚
- ç¡®ä¿åŸå§‹æ•°æ®ä¸å¯å˜æ€§ã€‚

------

### ğŸ’¡ **ç»å…¸åº”ç”¨åœºæ™¯**

1. **æ•°æ®å¤„ç†æµæ°´çº¿**ï¼ˆå¦‚ MapReduceï¼‰
2. **å“åº”å¼ç¼–ç¨‹**ï¼ˆå¦‚ React çŠ¶æ€ç®¡ç†ï¼‰
3. **é‡‘èäº¤æ˜“è®¡ç®—**ï¼ˆé¿å…å‰¯ä½œç”¨å’ŒçŠ¶æ€æ±¡æŸ“ï¼‰
4. **æ—¥å¿—å’Œå®¡è®¡**ï¼ˆçº¯å‡½æ•°ç”Ÿæˆä¸å¯å˜æ—¥å¿—ï¼‰

------

è¿™äº›ç»å…¸èŒƒå¼å’Œä½¿ç”¨åœºæ™¯éƒ½ä½“ç°äº†å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ï¼Œå³**é«˜å¯å¤ç”¨æ€§**ã€**æ˜“äºæµ‹è¯•**å’Œ**æ— å‰¯ä½œç”¨**ã€‚
 å¸Œæœ›è¿™æ ·è§£é‡Šèƒ½å¸®ä½ æ›´å¥½ç†è§£å‡½æ•°å¼ç¼–ç¨‹çš„ç²¾é«“ï¼ ğŸ˜„



## çº¯å‡½æ•°

**çº¯å‡½æ•°**çš„ç‰¹ç‚¹æ˜¯ï¼š

1. **ç›¸åŒè¾“å…¥å¿…å®šäº§ç”Ÿç›¸åŒè¾“å‡º**ã€‚
2. **æ²¡æœ‰å‰¯ä½œç”¨**ï¼Œå³å‡½æ•°ä¸ä¼šä¿®æ”¹å¤–éƒ¨çŠ¶æ€æˆ–ä¾èµ–å¤–éƒ¨çŠ¶æ€ã€‚

### éçº¯å‡½æ•°çš„ç»å…¸ä¾‹å­

1. **ä¿®æ”¹å…¨å±€å˜é‡çš„å‡½æ•°**ï¼š

   ```
   goCopyEditvar count int
   
   func increment() int {
       count++
       return count
   }
   ```

   - ç”±äºå‡½æ•°ä¾èµ–å’Œä¿®æ”¹å…¨å±€å˜é‡ï¼Œæ¯æ¬¡è°ƒç”¨çš„ç»“æœå¯èƒ½ä¸åŒï¼Œå› æ­¤æ˜¯éçº¯å‡½æ•°ã€‚

2. **è¯»å†™æ–‡ä»¶çš„å‡½æ•°**ï¼š

   ```
   goCopyEditfunc readFile(filename string) (string, error) {
       content, err := os.ReadFile(filename)
       return string(content), err
   }
   ```

   - è¯»å–çš„æ–‡ä»¶å†…å®¹å¯èƒ½ä¼šå› ä¸ºæ–‡ä»¶å†…å®¹å˜åŒ–è€Œä¸åŒï¼Œå› æ­¤ä¸æ˜¯çº¯å‡½æ•°ã€‚

3. **äº§ç”Ÿéšæœºæ•°çš„å‡½æ•°**ï¼š

   ```
   goCopyEditfunc getRandom() int {
       return rand.Intn(100)
   }
   ```

   - æ¯æ¬¡è°ƒç”¨éƒ½ä¼šè¿”å›ä¸åŒçš„å€¼ï¼Œå±äºéçº¯å‡½æ•°ã€‚

4. **ä¾èµ–æ—¶é—´çš„å‡½æ•°**ï¼š

   ```
   goCopyEditfunc currentTime() time.Time {
       return time.Now()
   }
   ```

   - æ¯æ¬¡è¿”å›çš„æ—¶é—´éƒ½ä¸åŒï¼Œå¯¼è‡´å‡½æ•°è¾“å‡ºä¸ä¸€è‡´ã€‚





# TBDï¼šfrom GPT

åœ¨ Go è¯­è¨€ä¸­ï¼Œè™½ç„¶å¾ˆå¤šä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è®¾è®¡æ¨¡å¼ç”±äºè¯­è¨€è‡ªèº«ç‰¹æ€§çš„åŸå› å¯ä»¥ä»¥æ›´ç®€å•æˆ–æ›´ç›´æ¥çš„æ–¹å¼å®ç°ï¼Œä½†ä»æœ‰ä¸€äº›æ¨¡å¼å¯¹äºæ„å»ºæ¸…æ™°ã€çµæ´»å’Œå¯ç»´æŠ¤çš„ä»£ç éå¸¸æœ‰ç”¨ã€‚ä¸‹é¢åˆ—å‡ºå‡ ç§å¸¸è§ä¸”æ¨èæŒæ¡çš„è®¾è®¡æ¨¡å¼ï¼Œä»¥åŠåœ¨ Go ä¸­å®ƒä»¬çš„å®ç°æ€è·¯å’Œå…¸å‹åº”ç”¨åœºæ™¯ï¼š

------

### 1. ç­–ç•¥æ¨¡å¼ (Strategy Pattern)

- **æ¦‚å¿µ**ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬å°è£…èµ·æ¥ï¼Œå¹¶ä½¿å®ƒä»¬å¯ä»¥äº’æ¢ã€‚è¿™æ ·ï¼Œç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“ä½¿ç”¨å®ƒä»¬çš„å®¢æˆ·ã€‚
- **Go å®ç°**ï¼šé€šè¿‡æ¥å£æ¥å®šä¹‰ä¸åŒç­–ç•¥ï¼Œåˆ©ç”¨ç»„åˆæˆ–å‡½æ•°å˜é‡ä¼ é€’å…·ä½“å®ç°ã€‚
- **åº”ç”¨åœºæ™¯**ï¼šä¾‹å¦‚ï¼Œæ ¹æ®ä¸åŒæ¡ä»¶é€‰æ‹©æ’åºç®—æ³•ã€æ—¥å¿—ç­–ç•¥ã€è®¤è¯ç­–ç•¥ç­‰ã€‚

*ç¤ºä¾‹*ï¼š

```go
type DiscountStrategy interface {
    Discount(amount float64) float64
}

type NoDiscount struct{}
func (n NoDiscount) Discount(amount float64) float64 {
    return amount
}

type PercentageDiscount struct {
    Percent float64
}
func (p PercentageDiscount) Discount(amount float64) float64 {
    return amount * (1 - p.Percent)
}

func CalculateFinalPrice(amount float64, strategy DiscountStrategy) float64 {
    return strategy.Discount(amount)
}
```

------

### 2. å·¥å‚æ¨¡å¼ (Factory Pattern)

- **æ¦‚å¿µ**ï¼šæä¾›ä¸€ä¸ªæ¥å£ç”¨äºåˆ›å»ºå¯¹è±¡ï¼Œä½†ç”±å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚å®ƒå¯ä»¥è®©ç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å­ç±»ä¸­è¿›è¡Œã€‚
- **Go å®ç°**ï¼šå¸¸ç”¨å·¥å‚å‡½æ•°ï¼ˆæˆ–æ–¹æ³•ï¼‰æ¥åˆ›å»ºå¹¶è¿”å›æ¥å£ç±»å‹çš„å®ä¾‹ï¼Œè€Œä¸æš´éœ²å…·ä½“çš„å®ç°ç»†èŠ‚ã€‚
- **åº”ç”¨åœºæ™¯**ï¼šä¾‹å¦‚ï¼Œåˆ›å»ºæ•°æ®åº“è¿æ¥ã€æ—¥å¿—è®°å½•å™¨æˆ–å…¶ä»–éœ€è¦æ ¹æ®é…ç½®å†³å®šå…·ä½“å®ç°çš„å¯¹è±¡ã€‚

*ç¤ºä¾‹*ï¼š

```go
type Logger interface {
    Log(message string)
}

type ConsoleLogger struct{}
func (ConsoleLogger) Log(message string) {
    fmt.Println("Console:", message)
}

type FileLogger struct {
    // æ–‡ä»¶ç›¸å…³å­—æ®µ
}
func (FileLogger) Log(message string) {
    // å†™å…¥æ–‡ä»¶
}

func NewLogger(loggerType string) Logger {
    if loggerType == "console" {
        return ConsoleLogger{}
    }
    // é»˜è®¤è¿”å›æ–‡ä»¶æ—¥å¿—å™¨
    return FileLogger{}
}
```

------

### 3. å•ä¾‹æ¨¡å¼ (Singleton Pattern)

- **æ¦‚å¿µ**ï¼šç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚
- **Go å®ç°**ï¼šåˆ©ç”¨åŒ…çº§å˜é‡å’Œ `sync.Once` å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹ã€‚
- **åº”ç”¨åœºæ™¯**ï¼šä¾‹å¦‚ï¼Œå…¨å±€é…ç½®ç®¡ç†ã€æ—¥å¿—å®ä¾‹ã€æ•°æ®åº“è¿æ¥æ± ç­‰ã€‚

*ç¤ºä¾‹*ï¼š

```go
var (
    instance *Config
    once     sync.Once
)

type Config struct {
    Port int
}

func GetConfig() *Config {
    once.Do(func() {
        instance = &Config{Port: 8080}
    })
    return instance
}
```

------

### 4. è§‚å¯Ÿè€…æ¨¡å¼ (Observer Pattern)

- **æ¦‚å¿µ**ï¼šå®šä¹‰å¯¹è±¡ä¹‹é—´çš„ä¸€ç§ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå…¶ç›¸å…³ä¾èµ–å¯¹è±¡éƒ½ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚
- **Go å®ç°**ï¼šé€šè¿‡æ¥å£å’Œå‡½æ•°å›è°ƒå®ç°è®¢é˜…-é€šçŸ¥æœºåˆ¶ã€‚
- **åº”ç”¨åœºæ™¯**ï¼šäº‹ä»¶é©±åŠ¨æ¶æ„ã€GUI åº”ç”¨ã€å®æ—¶æ•°æ®æ›´æ–°ç­‰ã€‚

*ç¤ºä¾‹*ï¼š

```go
type Observer interface {
    Update(data string)
}

type Subject struct {
    observers []Observer
}

func (s *Subject) Register(o Observer) {
    s.observers = append(s.observers, o)
}

func (s *Subject) Notify(data string) {
    for _, o := range s.observers {
        o.Update(data)
    }
}
```

------

### 5. è£…é¥°å™¨æ¨¡å¼ (Decorator Pattern)

- **æ¦‚å¿µ**ï¼šåŠ¨æ€åœ°ç»™å¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ï¼Œè€Œä¸æ”¹å˜å…¶æ¥å£ã€‚
- **Go å®ç°**ï¼šåˆ©ç”¨å‡½æ•°åŒ…è£…æˆ–ç»„åˆå®ç°ï¼Œå¸¸è§äºä¸­é—´ä»¶ã€æ‹¦æˆªå™¨çš„è®¾è®¡ã€‚
- **åº”ç”¨åœºæ™¯**ï¼šä¾‹å¦‚ï¼ŒHTTP è¯·æ±‚çš„ä¸­é—´ä»¶ã€æ—¥å¿—æ‹¦æˆªã€åŠŸèƒ½æ‰©å±•ç­‰ã€‚

*ç¤ºä¾‹*ï¼ˆä½¿ç”¨å‡½æ•°è£…é¥°å™¨ï¼‰ï¼š

```go
type Handler func()

func WithLogging(h Handler) Handler {
    return func() {
        fmt.Println("Start")
        h()
        fmt.Println("End")
    }
}

func mainHandler() {
    fmt.Println("Handling request")
}

func main() {
    decorated := WithLogging(mainHandler)
    decorated()
}
```

------

### 6. å‘½ä»¤æ¨¡å¼ (Command Pattern)

- **æ¦‚å¿µ**ï¼šå°†è¯·æ±‚å°è£…æˆå¯¹è±¡ï¼Œä»è€Œè®©ä½ ä½¿ç”¨ä¸åŒçš„è¯·æ±‚ã€é˜Ÿåˆ—æˆ–æ—¥å¿—æ¥å‚æ•°åŒ–å…¶ä»–å¯¹è±¡ã€‚å®ƒä¹Ÿæ”¯æŒå¯æ’¤é”€æ“ä½œã€‚
- **Go å®ç°**ï¼šå®šä¹‰ä¸€ä¸ªå‘½ä»¤æ¥å£å’Œå…·ä½“å‘½ä»¤å®ç°ï¼Œå¹¶é€šè¿‡è°ƒç”¨æ–¹æ³•æ¥æ‰§è¡Œå‘½ä»¤ã€‚
- **åº”ç”¨åœºæ™¯**ï¼šä¾‹å¦‚ï¼Œä»»åŠ¡é˜Ÿåˆ—ã€å®å‘½ä»¤ã€GUI æŒ‰é’®ç‚¹å‡»å¤„ç†ç­‰ã€‚

*ç¤ºä¾‹*ï¼š

```go
type Command interface {
    Execute()
}

type Light struct{}
func (l Light) On()  { fmt.Println("Light on") }
func (l Light) Off() { fmt.Println("Light off") }

type LightOnCommand struct {
    light Light
}
func (c LightOnCommand) Execute() {
    c.light.On()
}
```

------

### æ€»ç»“

ä½œä¸ºä¸€ä¸ª Go å¼€å‘è€…æˆ–å­¦ä¹ è€…ï¼Œå»ºè®®æŒæ¡ä»¥ä¸‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒä»¬åœ¨ Go ä¸­çš„å®ç°é€šå¸¸ä¾èµ–äºæ¥å£å’Œç»„åˆï¼š

- **ç­–ç•¥æ¨¡å¼**ï¼šåˆ©ç”¨æ¥å£å®ç°å¤šç§ç®—æ³•çš„äº’æ¢ã€‚
- **å·¥å‚æ¨¡å¼**ï¼šé€šè¿‡å·¥å‚å‡½æ•°éšè—å¯¹è±¡åˆ›å»ºç»†èŠ‚ã€‚
- **å•ä¾‹æ¨¡å¼**ï¼šåˆ©ç”¨ `sync.Once` ä¿è¯å…¨å±€å”¯ä¸€æ€§ã€‚
- **è§‚å¯Ÿè€…æ¨¡å¼**ï¼šå®ç°äº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚
- **è£…é¥°å™¨æ¨¡å¼**ï¼šé€šè¿‡å‡½æ•°åŒ…è£…æˆ–ç»“æ„ä½“ç»„åˆæ‰©å±•åŠŸèƒ½ã€‚
- **å‘½ä»¤æ¨¡å¼**ï¼šå°è£…è¯·æ±‚ä¸ºå¯¹è±¡ï¼Œå®ç°é˜Ÿåˆ—å’Œæ’¤é”€åŠŸèƒ½ã€‚

è¿™äº›æ¨¡å¼ä¸ä»…æœ‰åŠ©äºæ„å»ºçµæ´»ä¸”æ˜“ç»´æŠ¤çš„ä»£ç ç»“æ„ï¼Œè¿˜èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ Go çš„è®¾è®¡å“²å­¦â€”â€”é€šè¿‡ç»„åˆè€Œéç»§æ‰¿æ¥å®ç°è§£è€¦å’Œå¤ç”¨ã€‚